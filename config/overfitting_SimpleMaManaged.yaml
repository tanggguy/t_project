optimization:
  strategy:
    name: "SimpleMaManaged"
    module: "strategies.implementations.simple_ma_managed_strategy"
    class_name: "SimpleMaManagedStrategy"
    fixed_params:
      use_stop_loss: true
      stop_loss_type: "trailing"
      use_take_profit: true
      take_profit_type: "atr"
    param_space:
      fast_period: [4, 20, 1]
      slow_period: [40, 70, 5]
      stop_loss_pct: [0.01, 0.05, 0.005]
      take_profit_atr_mult:
        type: "float"
        low: 2.0
        high: 5.0
        step: 0.5

  data:
    ticker: "AAPL"
    start_date: "2019-01-01"
    end_date: "2025-11-01"
    interval: "1d"
    use_cache: true
    # Mode multi-ticker exemple (décommentez et renseignez weights)
    # tickers: ["AAPL", "MSFT"]
    # weights: { AAPL: 0.5, MSFT: 0.5 }
    # alignment: "intersection"  # ou "union"

  broker:
    initial_capital: 10000.0
    commission_pct: 0.001
    slippage_pct: 0.0

  position_sizing:
    enabled: false
    method: "fixed"
    fixed:
      pct_size: 0.5

  # Emplacement d'un best_params éventuel (facultatif, utile avec --use-best-params)
  output:
    best_params_path: "results/optimization/sma_managed_opt_best_params.yaml"

# Section spécifique overfitting
overfitting:
  run_id: "sma_managed_checks12-01"
  output_dir: "results/overfitting"

  # Paramètres de re-optimisation (utilisés par WFA)
  optimization:
    n_trials: 3
    sampler_seed: 42
    timeout: null
    storage: "sqlite:///results/optimization/wfa_studies.db"
    penalty_value: -1.0
    min_trades: 1
    enforce_fast_slow_gap: true

  wfa:
    enabled: true
    fold_config:
      train_years: 3
      test_months: 6
      step_months: 6

  oos:
    enabled: true
    # soit des fenêtres listées, soit une année glissante par défaut (years)
    windows:
      - ["2024-01-01", "2024-12-31"]
    years: 1

  monte_carlo:
    enabled: true
    source: "returns"   # "returns" ou "trades"
    n_simulations: 1000
    block_size: 5
    seed: 42

  stability:
    enabled: true
    perturbation: 0.1
    steps: 3
    threshold: 0.95

